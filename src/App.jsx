import React, { useState, useRef } from "react";
import { Home, Building2, Users, MessageCircle, User } from "lucide-react";
import { TrendingUp, Star, MapPin, DollarSign, Clock } from "lucide-react";

import "./App.css";

// 1. Common Components

const PageHeader = ({
  title,
  onBack,
  backButtonVisible = false,
  rightComponent,
  showLocationButton,
  currentLocation,
  onLocationSelect,
}) => (
  <div
    style={{
      padding: "1rem",
      display: "flex",
      alignItems: "center",
      justifyContent: "space-between",
    }}
  >
    <div style={{ display: "flex", alignItems: "center" }}>
      {backButtonVisible && (
        <button onClick={onBack} className="back-button">
          ‚Üê
        </button>
      )}
      <h1
        style={{
          fontSize: "1.25rem",
          fontWeight: "bold",
          marginLeft: backButtonVisible ? "0.5rem" : "0",
        }}
      >
        {title}
      </h1>
    </div>

    {showLocationButton ? (
      <button
        onClick={onLocationSelect}
        style={{
          backgroundColor: "#dbeafe",
          padding: "0.5rem 1rem",
          borderRadius: "9999px",
          border: "none",
          cursor: "pointer",
          color: "black",
          fontSize: "0.875rem",
          whiteSpace: "nowrap",
        }}
      >
        üìç {currentLocation}
      </button>
    ) : rightComponent ? (
      rightComponent
    ) : null}
  </div>
);

const LocationSelectButton = ({ currentLocation, onLocationSelect }) => (
  <button className="location-button" onClick={onLocationSelect}>
    üìç {currentLocation}
  </button>
);

const BottomNavigation = ({ currentPage, onNavigate }) => (
  <div className="bottom-navigation">
    <div className="bottom-navigation-inner">
      <button
        onClick={() => onNavigate("main")}
        className={`nav-button ${
          currentPage === "main" ? "nav-button-active" : "nav-button-inactive"
        }`}
      >
        <Home size={20} />
        <span>Ìôà</span>
      </button>
      <button
        onClick={() => onNavigate("gyms")}
        className={`nav-button ${
          currentPage === "gyms" ? "nav-button-active" : "nav-button-inactive"
        }`}
      >
        <Building2 size={20} />
        <span>Ïö¥ÎèôÏãúÏÑ§</span>
      </button>
      <button
        onClick={() => onNavigate("trainers")}
        className={`nav-button ${
          currentPage === "trainers"
            ? "nav-button-active"
            : "nav-button-inactive"
        }`}
      >
        <Users size={20} />
        <span>Ìä∏Î†àÏù¥ÎÑà</span>
      </button>
      <button
        onClick={() => onNavigate("community")}
        className={`nav-button ${
          currentPage === "community"
            ? "nav-button-active"
            : "nav-button-inactive"
        }`}
      >
        <MessageCircle size={20} />
        <span>Ïª§ÎÆ§ÎãàÌã∞</span>
      </button>
      <button
        onClick={() => onNavigate("mypage")}
        className={`nav-button ${
          currentPage === "mypage" ? "nav-button-active" : "nav-button-inactive"
        }`}
      >
        <User size={20} />
        <span>MY</span>
      </button>
    </div>
  </div>
);

// 2. Main Pages
const MainPage = ({ onNavigate, currentLocation }) => {
  return (
    <div className="container">
      <PageHeader
        title="Î™¨Ïßê ÏóêÏù¥Ï†ÑÌä∏"
        showLocationButton={true}
        currentLocation={currentLocation}
        onLocationSelect={() => onNavigate("location")}
      />{" "}
      <div
        style={{
          flex: 1,
          padding: "1rem 1rem 5rem 1rem",
          position: "relative",
        }}
      >
        {" "}
        {/* Quick Stats */}
        <div
          style={{
            display: "grid",
            gridTemplateColumns: "1fr 1fr 1fr",
            gap: "0.75rem",
            marginBottom: "1.5rem",
          }}
        >
          <StatsCard
            icon={<Users size={20} />}
            label="Ïù¥Ïö© ÌöåÏõê"
            value="2,841Î™Ö"
          />
          <StatsCard
            icon={<TrendingUp size={20} />}
            label="Ï†úÌú¥ ÏãúÏÑ§"
            value="267Í∞ú"
          />
          <StatsCard
            icon={<Star size={20} />}
            label="ÌèâÍ∑† ÌèâÏ†ê"
            value="4.8Ï†ê"
          />
        </div>
        {/* Featured Sections */}
        <div style={{ marginBottom: "1.5rem" }}>
          <SectionHeader
            title="Ï∂îÏ≤ú Ïö¥ÎèôÏãúÏÑ§"
            onViewAll={() => onNavigate("gyms")}
          />
          <div
            style={{ display: "flex", flexDirection: "column", gap: "0.75rem" }}
          >
            <FeaturedGymCard
              name="Ïä§Ìè¨Ïï†Îãà Í∞ïÎÇ®Ï†ê"
              rating={4.9}
              location="Í∞ïÎÇ®Íµ¨ Ïó≠ÏÇºÎèô"
              price="89,000"
              onClick={() => onNavigate("gymDetail", { id: 1 })}
            />
            <FeaturedGymCard
              name="24Ìïè ÏÑ†Î¶âÏ†ê"
              rating={4.8}
              location="Í∞ïÎÇ®Íµ¨ Ïó≠ÏÇºÎèô"
              price="79,000"
              onClick={() => onNavigate("gymDetail", { id: 2 })}
            />
          </div>
        </div>
        <div style={{ marginBottom: "1.5rem" }}>
          <SectionHeader
            title="Ïù∏Í∏∞ Ìä∏Î†àÏù¥ÎÑà"
            onViewAll={() => onNavigate("trainers")}
          />
          <div
            style={{
              display: "grid",
              gridTemplateColumns: "1fr 1fr",
              gap: "0.75rem",
            }}
          >
            <TrainerCard
              name="ÍπÄÏäπÌòÑ"
              specialty="Ï≤¥Ï§ëÍ∞êÎüâ"
              rating={4.9}
              experience="5ÎÖÑ"
              onClick={() => onNavigate("trainerDetail", { id: 1 })}
            />
            <TrainerCard
              name="Ïù¥ÏßÄÏõê"
              specialty="Í∑ºÎ†•Í∞ïÌôî"
              rating={4.8}
              experience="7ÎÖÑ"
              onClick={() => onNavigate("trainerDetail", { id: 2 })}
            />
          </div>
        </div>
        <div style={{ marginBottom: "1.5rem" }}>
          <SectionHeader
            title="Ïù∏Í∏∞ Í≤åÏãúÍ∏Ä"
            onViewAll={() => onNavigate("community")}
          />
          <div
            style={{ display: "flex", flexDirection: "column", gap: "0.75rem" }}
          >
            <CommunityPostCard
              title="40ÎåÄ ÏßÅÏû•Ïù∏Ïùò ÏÑ±Í≥µÏ†ÅÏù∏ Îã§Ïù¥Ïñ¥Ìä∏ ÌõÑÍ∏∞"
              author="Ìó¨Ïä§Ïôï"
              likes={142}
              comments={38}
              onClick={() => onNavigate("communityDetail", { id: 1 })}
            />
            <CommunityPostCard
              title="PT Ìä∏Î†àÏù¥ÎÑàÍ∞Ä ÏïåÎ†§Ï£ºÎäî ÏãùÎã® Í¥ÄÎ¶¨ ÌåÅ"
              author="ÌîÑÎ°úÌä∏Î†àÏù¥ÎÑà"
              likes={98}
              comments={27}
              onClick={() => onNavigate("communityDetail", { id: 2 })}
            />
          </div>
        </div>
      </div>
      <BottomNavigation currentPage="main" onNavigate={onNavigate} />
    </div>
  );
};

const SectionHeader = ({ title, onViewAll }) => (
  <div
    style={{
      display: "flex",
      justifyContent: "space-between",
      alignItems: "center",
      marginBottom: "1rem",
    }}
  >
    <h2
      style={{
        fontSize: "1.125rem",
        fontWeight: "bold",
      }}
    >
      {title}
    </h2>
    <button
      onClick={onViewAll}
      className="primary-button"
      style={{
        width: "auto",
        padding: "0.5rem 1rem",
        fontSize: "0.875rem",
      }}
    >
      Ï†ÑÏ≤¥Î≥¥Í∏∞
    </button>
  </div>
);

const StatsCard = ({ icon, label, value }) => (
  <div
    className="card"
    style={{
      backgroundColor: "#dbeafe",
      padding: "0.75rem",
      borderRadius: "0.75rem",
      textAlign: "center",
    }}
  >
    <div
      style={{
        display: "flex",
        alignItems: "center",
        justifyContent: "center",
        backgroundColor: "#3b82f6",
        width: "2rem",
        height: "2rem",
        borderRadius: "0.5rem",
        marginBottom: "0.5rem",
        marginLeft: "auto",
        marginRight: "auto",
        color: "white",
      }}
    >
      {icon}
    </div>
    <div
      style={{
        fontSize: "0.75rem",
        color: "#4b5563",
        marginBottom: "0.25rem",
      }}
    >
      {label}
    </div>
    <div
      style={{
        fontSize: "1.125rem",
        fontWeight: "bold",
        color: "#1e3a8a",
      }}
    >
      {value}
    </div>
  </div>
);

const FeaturedGymCard = ({ name, rating, location, price, onClick }) => (
  <button
    onClick={onClick}
    className="card gym-trainer-item"
    style={{
      width: "100%",
      textAlign: "left",
      cursor: "pointer",
      padding: "0.75rem",
    }}
  >
    <div className="gym-trainer-item-image" />
    <div className="gym-trainer-item-content">
      <h3 style={{ fontWeight: "bold", margin: 0 }}>{name}</h3>
      <div
        style={{
          display: "flex",
          alignItems: "center",
          color: "#fbbf24",
          marginTop: "0.25rem",
        }}
      >
        <Star size={16} style={{ marginRight: "0.25rem" }} />
        <span style={{ fontSize: "0.875rem" }}>{rating}</span>
      </div>
      <div
        style={{
          display: "flex",
          gap: "0.75rem",
          marginTop: "0.25rem",
          color: "#6b7280",
          fontSize: "0.875rem",
        }}
      >
        <div style={{ display: "flex", alignItems: "center" }}>
          <MapPin size={16} style={{ marginRight: "0.25rem" }} />
          <span>{location}</span>
        </div>
        <div style={{ display: "flex", alignItems: "center" }}>
          <DollarSign size={16} style={{ marginRight: "0.25rem" }} />
          <span>{price}Ïõê/Ïõî</span>
        </div>
      </div>
    </div>
  </button>
);

const TrainerCard = ({ name, specialty, rating, experience, onClick }) => (
  <button
    onClick={onClick}
    className="card"
    style={{
      width: "100%",
      textAlign: "left",
      cursor: "pointer",
      padding: "0.75rem",
    }}
  >
    <div
      className="gym-trainer-item-image"
      style={{ marginBottom: "0.75rem" }}
    />
    <h3 style={{ fontWeight: "bold", margin: 0 }}>{name}</h3>
    <div
      style={{
        display: "flex",
        alignItems: "center",
        color: "#fbbf24",
        margin: "0.25rem 0",
      }}
    >
      <Star size={16} style={{ marginRight: "0.25rem" }} />
      <span style={{ fontSize: "0.875rem" }}>{rating}</span>
    </div>
    <div style={{ fontSize: "0.875rem", color: "#6b7280" }}>
      <div
        style={{
          display: "flex",
          alignItems: "center",
          marginBottom: "0.25rem",
        }}
      >
        <Users size={16} style={{ marginRight: "0.25rem" }} />
        <span>{specialty}</span>
      </div>
      <div style={{ display: "flex", alignItems: "center" }}>
        <Clock size={16} style={{ marginRight: "0.25rem" }} />
        <span>Í≤ΩÎ†• {experience}</span>
      </div>
    </div>
  </button>
);

const CommunityPostCard = ({ title, author, likes, comments, onClick }) => (
  <button
    onClick={onClick}
    className="card community-post"
    style={{
      width: "100%",
      textAlign: "left",
      cursor: "pointer",
    }}
  >
    <h3
      style={{
        fontWeight: "bold",
        marginBottom: "0.5rem",
      }}
    >
      {title}
    </h3>
    <div
      style={{
        display: "flex",
        justifyContent: "space-between",
        fontSize: "0.875rem",
      }}
    >
      <span style={{ color: "#6b7280" }}>{author}</span>
      <div
        style={{
          display: "flex",
          gap: "0.75rem",
          color: "#6b7280",
        }}
      >
        <span>üëç {likes}</span>
        <span>üí¨ {comments}</span>
      </div>
    </div>
  </button>
);

const LocationPage = ({ onNavigate }) => {
  const [selectedCity, setSelectedCity] = React.useState(null);

  const cities = [
    { id: "seoul", name: "ÏÑúÏö∏" },
    { id: "gyeonggi", name: "Í≤ΩÍ∏∞" },
    { id: "incheon", name: "Ïù∏Ï≤ú" },
    { id: "busan", name: "Î∂ÄÏÇ∞" },
    { id: "daegu", name: "ÎåÄÍµ¨" },
  ];

  const districts = {
    seoul: ["Í∞ïÎÇ®Íµ¨", "ÏÑúÏ¥àÍµ¨", "ÏÜ°ÌååÍµ¨", "Í∞ïÎèôÍµ¨", "ÎßàÌè¨Íµ¨"],
    gyeonggi: ["ÏàòÏõêÏãú", "ÏÑ±ÎÇ®Ïãú", "Í≥†ÏñëÏãú", "Ïö©Ïù∏Ïãú", "Î∂ÄÏ≤úÏãú"],
    incheon: ["Ï§ëÍµ¨", "ÎèôÍµ¨", "ÎØ∏Ï∂îÌôÄÍµ¨", "Ïó∞ÏàòÍµ¨", "ÎÇ®ÎèôÍµ¨"],
    busan: ["Ï§ëÍµ¨", "ÏÑúÍµ¨", "ÎèôÍµ¨", "ÏòÅÎèÑÍµ¨", "Î∂ÄÏÇ∞ÏßÑÍµ¨"],
    daegu: ["Ï§ëÍµ¨", "ÎèôÍµ¨", "ÏÑúÍµ¨", "ÎÇ®Íµ¨", "Î∂ÅÍµ¨"],
  };

  if (!selectedCity) {
    return (
      <div className="container">
        <PageHeader
          title="ÏßÄÏó≠ ÏÑ†ÌÉù"
          onBack={() => onNavigate("back")}
          backButtonVisible={true}
        />
        <div style={{ flex: 1, padding: "1rem" }}>
          <div
            style={{
              display: "grid",
              gridTemplateColumns: "1fr 1fr",
              gap: "1rem",
            }}
          >
            {cities.map((city) => (
              <button
                key={city.id}
                onClick={() => setSelectedCity(city)}
                className="location-selection-button"
              >
                {city.name}
              </button>
            ))}
          </div>
        </div>
      </div>
    );
  }

  return (
    <div className="container">
      <PageHeader
        title={`${selectedCity.name} ÏßÄÏó≠ ÏÑ†ÌÉù`}
        onBack={() => setSelectedCity(null)}
        backButtonVisible={true}
      />
      <div style={{ flex: 1, padding: "1rem" }}>
        <div
          style={{
            display: "grid",
            gridTemplateColumns: "1fr 1fr",
            gap: "1rem",
          }}
        >
          {districts[selectedCity.id].map((district) => (
            <button
              key={district}
              onClick={() =>
                onNavigate("back", {
                  selectedLocation: `${selectedCity.name} ${district}`,
                })
              }
              className="location-selection-button"
              style={{
                textAlign: "center", // Ï§ëÏïô Ï†ïÎ†¨Î°ú Î≥ÄÍ≤Ω
                justifyContent: "center", // Ï∂îÍ∞Ä: ÌîåÎ†âÏä§ Ï§ëÏïô Ï†ïÎ†¨
              }}
            >
              {district}
            </button>
          ))}
        </div>
      </div>
    </div>
  );
};

const GymListPage = ({ onNavigate, currentLocation }) => {
  const [activeTab, setActiveTab] = useState(0);
  const [touchStart, setTouchStart] = useState(null);
  const [touchEnd, setTouchEnd] = useState(null);
  const contentRef = useRef(null);

  const tabs = [
    { id: 0, name: "Ìó¨Ïä§Ïû•" },
    { id: 1, name: "ÌïÑÎùºÌÖåÏä§" },
    { id: 2, name: "Ï£ºÏßìÏàò" },
  ];

  const gymData = {
    Ìó¨Ïä§Ïû•: Array.from({ length: 15 }, (_, i) => ({
      id: i + 1,
      name: `Ïä§Ìè¨Ïï†Îãà ${i + 1}Ìò∏Ï†ê`,
      location: "Í∞ïÎÇ®Íµ¨ Ïó≠ÏÇºÎèô",
      rating: 4.5,
      price: "80,000",
    })),
    ÌïÑÎùºÌÖåÏä§: Array.from({ length: 4 }, (_, i) => ({
      id: i + 1,
      name: `ÏΩîÏñ¥ÌïÑÎùºÌÖåÏä§ ${i + 1}Ìò∏Ï†ê`,
      location: "Í∞ïÎÇ®Íµ¨ Ïó≠ÏÇºÎèô",
      rating: 4.8,
      price: "150,000",
    })),
    Ï£ºÏßìÏàò: Array.from({ length: 3 }, (_, i) => ({
      id: i + 1,
      name: `Í∑∏Î†àÏù¥ÏãúÎ∞îÌïò ${i + 1}Ìò∏Ï†ê`,
      location: "Í∞ïÎÇ®Íµ¨ Ïó≠ÏÇºÎèô",
      rating: 4.7,
      price: "120,000",
    })),
  };

  const handleTouchStart = (e) => {
    setTouchStart(e.touches[0].clientX);
  };

  const handleTouchMove = (e) => {
    setTouchEnd(e.touches[0].clientX);
  };

  const handleTouchEnd = () => {
    if (!touchStart || !touchEnd) return;

    const distance = touchStart - touchEnd;
    const isLeftSwipe = distance > 50;
    const isRightSwipe = distance < -50;

    if (isLeftSwipe && activeTab < tabs.length - 1) {
      setActiveTab((prev) => prev + 1);
    }
    if (isRightSwipe && activeTab > 0) {
      setActiveTab((prev) => prev - 1);
    }

    setTouchStart(null);
    setTouchEnd(null);
  };

  return (
    <div className="container">
      <PageHeader
        title="Ïö¥ÎèôÏãúÏÑ§ Î™©Î°ù"
        showLocationButton={true}
        currentLocation={currentLocation}
        onLocationSelect={() => onNavigate("location")}
      />

      <div style={{ position: "relative", flex: 1, overflowY: "hidden" }}>
        {/* Tabs */}
        <div
          style={{
            position: "absolute",
            top: 0,
            left: 0,
            right: 0,
            backgroundColor: "white",
            zIndex: 10,
            borderBottom: "1px solid #e5e7eb",
          }}
        >
          <div
            style={{
              display: "flex",
              gap: "4px",
              padding: "8px",
            }}
          >
            {tabs.map((tab) => (
              <button
                key={tab.id}
                onClick={() => setActiveTab(tab.id)}
                style={{
                  flex: 1,
                  padding: "8px 16px",
                  borderRadius: "8px",
                  fontSize: "14px",
                  fontWeight: "500",
                  transition: "all 0.2s",
                  backgroundColor: activeTab === tab.id ? "#3b82f6" : "#f3f4f6",
                  color: activeTab === tab.id ? "white" : "#4b5563",
                  border: "none",
                  cursor: "pointer",
                }}
              >
                {tab.name}
              </button>
            ))}
          </div>
        </div>

        {/* Content Area */}
        <div
          ref={contentRef}
          style={{
            height: "100%",
            overflowY: "auto",
          }}
          onTouchStart={handleTouchStart}
          onTouchMove={handleTouchMove}
          onTouchEnd={handleTouchEnd}
        >
          <div
            style={{
              display: "flex",
              flexDirection: "column",
              gap: "1rem",
              padding: "0.5rem 0.5rem 1.5rem",
            }}
          >
            {gymData[tabs[activeTab].name].map((gym) => (
              <button
                key={gym.id}
                onClick={() => onNavigate("gymDetail", { id: gym.id })}
                className="card gym-trainer-item"
                style={{ textAlign: "left", cursor: "pointer" }}
              >
                <div className="gym-trainer-item-image" />
                <div className="gym-trainer-item-content">
                  <h3 style={{ fontWeight: "bold", margin: 0 }}>{gym.name}</h3>
                  <p style={{ margin: "0.25rem 0" }}>{gym.location}</p>
                  <p style={{ margin: "0.25rem 0" }}>‚≠êÔ∏è {gym.rating}</p>
                  <p style={{ margin: "0.25rem 0" }}>{gym.price}Ïõê/Ïõî</p>
                </div>
              </button>
            ))}
          </div>
        </div>
      </div>
      <BottomNavigation currentPage="gyms" onNavigate={onNavigate} />
    </div>
  );
};

const GymDetailPage = ({ onNavigate }) => {
  const membershipRef = useRef(null);
  const membershipPlans = [
    { duration: "3Í∞úÏõî", price: "60,000Ïõê" },
    { duration: "6Í∞úÏõî", price: "110,000Ïõê" },
    { duration: "12Í∞úÏõî", price: "200,000Ïõê" },
  ];

  const scrollToMembership = () => {
    membershipRef.current?.scrollIntoView({ behavior: "smooth" });
  };

  const handlePlanClick = (plan) => {
    onNavigate("payment", { plan, source: "gym" });
  };

  return (
    <div className="container" style={{ backgroundColor: "white" }}>
      <div className="detail-page-header">
        <button onClick={() => onNavigate("back")} className="back-button">
          ‚Üê
        </button>
        <h1
          style={{
            flex: 1,
            textAlign: "center",
            fontSize: "1.25rem",
            fontWeight: "bold",
          }}
        >
          Ïö¥ÎèôÏãúÏÑ§ ÏÉÅÏÑ∏
        </h1>
        <div style={{ width: "2rem" }} />
      </div>

      <div style={{ flex: 1, padding: "1rem 2rem", overflow: "auto" }}>
        <div className="detail-page-image" />
        <div style={{ marginBottom: "2.5rem" }}>
          <h2
            style={{
              fontSize: "1.25rem",
              fontWeight: "bold",
              marginBottom: "0.5rem",
            }}
          >
            Ïä§ÎßàÌä∏ ÌîºÌä∏ÎãàÏä§
          </h2>
          <p style={{ marginBottom: "0.25rem" }}>‚≠êÔ∏è 4.5</p>
          <p style={{ marginBottom: "0.25rem" }}>üìç Í∞ïÎÇ®Íµ¨ Ïó≠ÏÇºÎèô</p>
        </div>

        <div style={{ marginBottom: "2.5rem" }}>
          <h3 style={{ fontWeight: "bold", marginBottom: "0.5rem" }}>
            ÏãúÏÑ§ Ï†ïÎ≥¥
          </h3>
          <ul style={{ paddingLeft: "1.25rem", listStyle: "disc" }}>
            <li style={{ marginBottom: "0.25rem" }}>ÏÉ§ÏõåÏã§</li>
            <li style={{ marginBottom: "0.25rem" }}>Ïö¥ÎèôÎ≥µ ÎåÄÏó¨</li>
            <li style={{ marginBottom: "0.25rem" }}>Í∞úÏù∏ ÎùΩÏª§</li>
            <li style={{ marginBottom: "0.25rem" }}>Ï£ºÏ∞®Ïû•</li>
          </ul>
        </div>

        <div style={{ marginBottom: "2.5rem" }}>
          <h3 style={{ fontWeight: "bold", marginBottom: "0.5rem" }}>
            ÏúÑÏπòÎ≥¥Í∏∞
          </h3>
          <div
            style={{
              backgroundColor: "#f3f4f6",
              borderRadius: "0.75rem",
              overflow: "hidden",
              padding: "1rem",
              maxWidth: "50%",
              margin: "0 auto",
            }}
          >
            <svg viewBox="0 0 400 200" xmlns="http://www.w3.org/2000/svg">
              {/* Background */}
              <rect width="400" height="200" fill="#e5e7eb" rx="8" />

              {/* Map Features */}
              <path
                d="M50 50 L350 50 L350 150 L50 150 Z"
                fill="#f3f4f6"
                stroke="#d1d5db"
                strokeWidth="2"
              />

              {/* Buildings */}
              <rect x="120" y="60" width="30" height="20" fill="#d1d5db" />
              <rect x="170" y="60" width="25" height="30" fill="#d1d5db" />
              <rect x="230" y="85" width="40" height="25" fill="#d1d5db" />
              <rect x="120" y="100" width="35" height="35" fill="#d1d5db" />
              <rect x="280" y="60" width="30" height="40" fill="#d1d5db" />

              {/* Roads */}
              <path d="M100 50 L100 150" stroke="#9ca3af" strokeWidth="2" />
              <path d="M200 50 L200 150" stroke="#9ca3af" strokeWidth="2" />
              <path d="M300 50 L300 150" stroke="#9ca3af" strokeWidth="2" />
              <path d="M50 75 L350 75" stroke="#9ca3af" strokeWidth="2" />
              <path d="M50 125 L350 125" stroke="#9ca3af" strokeWidth="2" />

              {/* Location Pin */}
              <g transform="translate(200,100)">
                {/* Pin Shadow */}
                <ellipse cx="0" cy="2" rx="8" ry="4" fill="rgba(0,0,0,0.2)" />

                {/* Pin Body */}
                <path
                  d="M0,-25 C11,-25 20,-15.5 20,-4 C20,7.5 0,25 0,25 C0,25 -20,7.5 -20,-4 C-20,-15.5 -11,-25 0,-25"
                  fill="#ef4444"
                  stroke="#dc2626"
                  strokeWidth="2"
                />

                {/* Pin Center */}
                <circle cx="0" cy="-4" r="6" fill="white" />
              </g>

              {/* Scale Indicator */}
              <g transform="translate(60,170)">
                <line
                  x1="0"
                  y1="0"
                  x2="50"
                  y2="0"
                  stroke="#6b7280"
                  strokeWidth="2"
                />
                <text
                  x="25"
                  y="15"
                  fontSize="10"
                  fill="#6b7280"
                  textAnchor="middle"
                >
                  100m
                </text>
              </g>

              {/* North Indicator */}
              <g transform="translate(340,30)">
                <circle
                  cx="0"
                  cy="0"
                  r="15"
                  fill="white"
                  stroke="#6b7280"
                  strokeWidth="1"
                />
                <text
                  x="0"
                  y="5"
                  fontSize="12"
                  fill="#6b7280"
                  textAnchor="middle"
                >
                  N
                </text>
              </g>
            </svg>
          </div>
          <p
            style={{
              fontSize: "0.875rem",
              color: "#6b7280",
              marginTop: "0.5rem",
            }}
          >
            üìç ÏÑúÏö∏ÌäπÎ≥ÑÏãú Í∞ïÎÇ®Íµ¨ Ïó≠ÏÇºÎèô 123-45
          </p>
        </div>

        <div style={{ marginBottom: "2.5rem" }}>
          <h3
            ref={membershipRef}
            style={{ fontWeight: "bold", marginBottom: "0.5rem" }}
          >
            Î©§Î≤ÑÏã≠ ÏöîÍ∏à
          </h3>
          <div
            style={{ display: "flex", flexDirection: "column", gap: "0.75rem" }}
          >
            {membershipPlans.map((plan) => (
              <div
                key={plan.duration}
                onClick={() => handlePlanClick(plan)}
                style={{
                  padding: "0.75rem",
                  backgroundColor: "#f3f4f6",
                  borderRadius: "0.5rem",
                  border: "none",
                  cursor: "pointer",
                  display: "flex",
                  justifyContent: "space-between",
                  alignItems: "center",
                }}
              >
                <div>
                  <div
                    style={{
                      color: "black",
                      fontWeight: "500",
                      marginBottom: "0.25rem",
                    }}
                  >
                    {plan.duration}
                  </div>
                  <div style={{ color: "#3b82f6", fontWeight: "bold" }}>
                    {plan.price}/Ïõî
                  </div>
                </div>
                <button
                  onClick={(e) => {
                    e.stopPropagation();
                    handlePlanClick(plan);
                  }}
                  style={{
                    padding: "0.5rem 0.75rem",
                    backgroundColor: "#3b82f6",
                    color: "white",
                    border: "none",
                    borderRadius: "0.375rem",
                    cursor: "pointer",
                    fontSize: "0.875rem",
                    marginLeft: "1rem",
                  }}
                >
                  Í≤∞Ï†úÌïòÍ∏∞
                </button>
              </div>
            ))}
          </div>
        </div>
      </div>

      <div className="detail-page-footer">
        <div style={{ display: "flex", gap: "0.5rem" }}>
          <button onClick={scrollToMembership} className="primary-button">
            ÏöîÍ∏àÎ≥¥Í∏∞
          </button>
          <button className="primary-button">Ï†ÑÌôîÍ±∏Í∏∞</button>
          <button className="primary-button">Ï†ÑÌôîÎ∞õÍ∏∞</button>
        </div>
      </div>
    </div>
  );
};

const TrainerListPage = ({ onNavigate, currentLocation }) => (
  <div className="container">
    <PageHeader
      title="Ìä∏Î†àÏù¥ÎÑà Î™©Î°ù"
      showLocationButton={true}
      currentLocation={currentLocation}
      onLocationSelect={() => onNavigate("location")}
    />{" "}
    <div
      style={{ flex: 1, padding: "1rem 1rem 5rem 1rem", position: "relative" }}
    >
      {" "}
      <div style={{ display: "flex", flexDirection: "column", gap: "1rem" }}>
        {[1, 2, 3, 4, 5, 6, 7, 8, 9].map((id) => (
          <button
            key={id}
            onClick={() => onNavigate("trainerDetail", { id })}
            className="card gym-trainer-item"
            style={{ textAlign: "left", cursor: "pointer" }}
          >
            <div className="gym-trainer-item-image" />
            <div className="gym-trainer-item-content">
              <h3 style={{ fontWeight: "bold", margin: 0 }}>ÍπÄÌä∏Î†àÏù¥ÎÑà {id}</h3>
              <p style={{ margin: "0.25rem 0" }}>Ï≤¥Ï§ëÍ∞êÎüâ, Í∑ºÎ†•Í∞ïÌôî</p>
              <p style={{ margin: "0.25rem 0" }}>‚≠êÔ∏è 4.8</p>
              <p style={{ margin: "0.25rem 0" }}>100,000Ïõê/Ìöå</p>
            </div>
          </button>
        ))}
      </div>
    </div>
    <BottomNavigation currentPage="trainers" onNavigate={onNavigate} />
  </div>
);

const TrainerDetailPage = ({ onNavigate }) => {
  const lessonRef = useRef(null);
  const lessonPlans = [
    {
      sessions: "30Ìöå",
      pricePerSession: "60,000Ïõê",
      totalPrice: "1,800,000Ïõê",
    },
    {
      sessions: "20Ìöå",
      pricePerSession: "70,000Ïõê",
      totalPrice: "1,400,000Ïõê",
    },
    { sessions: "10Ìöå", pricePerSession: "80,000Ïõê", totalPrice: "800,000Ïõê" },
  ];

  const scrollToLesson = () => {
    lessonRef.current?.scrollIntoView({ behavior: "smooth" });
  };

  const handlePlanClick = (plan) => {
    onNavigate("payment", { plan, source: "trainer" });
  };

  return (
    <div className="container" style={{ backgroundColor: "white" }}>
      <div className="detail-page-header">
        <button onClick={() => onNavigate("back")} className="back-button">
          ‚Üê
        </button>
        <h1
          style={{
            flex: 1,
            textAlign: "center",
            fontSize: "1.25rem",
            fontWeight: "bold",
          }}
        >
          Ìä∏Î†àÏù¥ÎÑà ÏÉÅÏÑ∏
        </h1>
        <div style={{ width: "2rem" }} />
      </div>

      <div style={{ flex: 1, padding: "1rem 2rem", overflow: "auto" }}>
        <div className="detail-page-image" />
        <div style={{ marginBottom: "1.5rem" }}>
          <h2
            style={{
              fontSize: "1.25rem",
              fontWeight: "bold",
              marginBottom: "0.5rem",
            }}
          >
            ÍπÄÌä∏Î†àÏù¥ÎÑà
          </h2>
          <p style={{ marginBottom: "0.25rem" }}>‚≠êÔ∏è 4.8</p>
          <p style={{ marginBottom: "0.25rem" }}>üí™ Ï≤¥Ï§ëÍ∞êÎüâ, Í∑ºÎ†•Í∞ïÌôî</p>
          <p style={{ marginBottom: "0.25rem" }}>üìù Í≤ΩÎ†• 5ÎÖÑ</p>
        </div>

        <div style={{ marginBottom: "1.5rem" }}>
          <h3 style={{ fontWeight: "bold", marginBottom: "0.5rem" }}>ÏûêÍ≤©Ï¶ù</h3>
          <ul style={{ paddingLeft: "1.25rem", listStyle: "disc" }}>
            <li>ÏÉùÌôúÏä§Ìè¨Ï∏†ÏßÄÎèÑÏÇ¨ 2Í∏â</li>
            <li>NSCA-CPT</li>
            <li>KATA-PTS</li>
          </ul>
        </div>

        <div style={{ marginBottom: "1.5rem" }}>
          <h3 style={{ fontWeight: "bold", marginBottom: "0.5rem" }}>
            ÏÉÅÎã¥ Í∞ÄÎä• ÏãúÍ∞Ñ
          </h3>
          <p>ÌèâÏùº 09:00 - 22:00</p>
        </div>

        <div style={{ marginBottom: "2.5rem" }}>
          <h3
            ref={lessonRef}
            style={{ fontWeight: "bold", marginBottom: "0.5rem" }}
          >
            Î†àÏä® ÏöîÍ∏à
          </h3>
          <div
            style={{ display: "flex", flexDirection: "column", gap: "0.75rem" }}
          >
            {lessonPlans.map((plan) => (
              <div
                key={plan.sessions}
                onClick={() => handlePlanClick(plan)}
                style={{
                  padding: "0.75rem",
                  backgroundColor: "#f3f4f6",
                  borderRadius: "0.5rem",
                  border: "none",
                  cursor: "pointer",
                  display: "flex",
                  justifyContent: "space-between",
                  alignItems: "center",
                }}
              >
                <div>
                  <div
                    style={{
                      color: "black",
                      fontWeight: "500",
                      marginBottom: "0.25rem",
                    }}
                  >
                    {plan.sessions}
                  </div>
                  <div style={{ color: "#6b7280", fontSize: "0.875rem" }}>
                    ÌöåÎãπ {plan.pricePerSession}
                  </div>
                  <div style={{ color: "#3b82f6", fontWeight: "bold" }}>
                    Ï¥ù {plan.totalPrice}
                  </div>
                </div>
                <button
                  onClick={(e) => {
                    e.stopPropagation();
                    handlePlanClick(plan);
                  }}
                  style={{
                    padding: "0.5rem 0.75rem",
                    backgroundColor: "#3b82f6",
                    color: "white",
                    border: "none",
                    borderRadius: "0.375rem",
                    cursor: "pointer",
                    fontSize: "0.875rem",
                    marginLeft: "1rem",
                  }}
                >
                  Í≤∞Ï†úÌïòÍ∏∞
                </button>
              </div>
            ))}
          </div>
        </div>
      </div>

      <div
        style={{
          padding: "1rem",
          backgroundColor: "white",
          borderTop: "1px solid #e5e7eb",
          position: "sticky",
          bottom: 0,
        }}
      >
        <div style={{ display: "flex", gap: "0.5rem" }}>
          <button
            onClick={scrollToLesson}
            className="primary-button"
            style={{ flex: 1 }}
          >
            ÏöîÍ∏àÎ≥¥Í∏∞
          </button>
          <button className="primary-button" style={{ flex: 1 }}>
            Ï†ÑÌôîÎ∞õÍ∏∞
          </button>
        </div>
      </div>
    </div>
  );
};

const MyPage = ({ onNavigate }) => (
  <div className="container">
    <PageHeader title="ÎßàÏù¥ ÌéòÏù¥ÏßÄ" />
    <div style={{ flex: 1, padding: "1rem 1rem", position: "relative" }}>
      <div className="card profile-section" style={{ marginBottom: "1.5rem" }}>
        <div
          style={{
            display: "flex",
            alignItems: "center",
            marginBottom: "1rem",
          }}
        >
          <div className="profile-avatar" />
          <div style={{ marginLeft: "1rem" }}>
            <h2 style={{ fontWeight: "bold", fontSize: "1.125rem" }}>Ìó¨Ïä§Ïôï</h2>
            <p style={{ color: "#6b7280" }}>user@example.com</p>
          </div>
        </div>
        <button className="secondary-button">ÌîÑÎ°úÌïÑ ÏàòÏ†ï</button>
      </div>

      <div style={{ display: "flex", flexDirection: "column", gap: "1rem" }}>
        <div
          className="card profile-section"
          style={{ marginBottom: "1.5rem" }}
        >
          <button className="mypage-card-button">
            <span className="mypage-card-button-text">ÎÇ¥ Ïù¥Ïö©Í∂å</span>
            <span className="mypage-card-button-icon">‚Üí</span>
          </button>
          <button className="mypage-card-button">
            <span className="mypage-card-button-text">Í≤∞Ï†ú ÎÇ¥Ïó≠</span>
            <span className="mypage-card-button-icon">‚Üí</span>
          </button>
          <button className="mypage-card-button">
            <span className="mypage-card-button-text">ÏòàÏïΩ ÎÇ¥Ïó≠</span>
            <span className="mypage-card-button-icon">‚Üí</span>
          </button>
        </div>

        <div
          className="card profile-section"
          style={{ marginBottom: "1.5rem" }}
        >
          <button className="mypage-card-button">
            <span className="mypage-card-button-text">Í≥µÏßÄÏÇ¨Ìï≠</span>
            <span className="mypage-card-button-icon">‚Üí</span>
          </button>
          <button className="mypage-card-button">
            <span className="mypage-card-button-text">ÏûêÏ£º Î¨ªÎäî ÏßàÎ¨∏</span>
            <span className="mypage-card-button-icon">‚Üí</span>
          </button>
          <button className="mypage-card-button">
            <span className="mypage-card-button-text">1:1 Î¨∏Ïùò</span>
            <span className="mypage-card-button-icon">‚Üí</span>
          </button>
        </div>

        <button
          style={{
            width: "100%",
            padding: "1rem",
            textAlign: "left",
            color: "#ef4444",
            backgroundColor: "white",
            borderRadius: "0.75rem",
            border: "none",
            cursor: "pointer",
          }}
        >
          Î°úÍ∑∏ÏïÑÏõÉ
        </button>
      </div>
    </div>
    <BottomNavigation currentPage="mypage" onNavigate={onNavigate} />
  </div>
);

const CommunityPage = ({ onNavigate, currentLocation }) => (
  <div className="container">
    <PageHeader
      title="Ïª§ÎÆ§ÎãàÌã∞"
      showLocationButton={true}
      currentLocation={currentLocation}
      onLocationSelect={() => onNavigate("location")}
    />{" "}
    <div
      style={{ flex: 1, padding: "1rem 1rem 5rem 1rem", position: "relative" }}
    >
      <div style={{ display: "flex", flexDirection: "column", gap: "1rem" }}>
        {[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].map((id) => (
          <button
            key={id}
            onClick={() => onNavigate("communityDetail", { id })}
            className="card community-post"
            style={{ width: "100%", textAlign: "left" }}
          >
            <h3>Ïö¥Îèô Ï¥àÎ≥¥Ïûê PT Ï∂îÏ≤úÌï¥Ï£ºÏÑ∏Ïöî {id}</h3>
            <div>
              <span>Ìó¨Î¶∞Ïù¥</span>
              <span>2024-02-06</span>
            </div>
            <div>
              <span>üëç 24</span>
              <span>üí¨ 12</span>
            </div>
          </button>
        ))}
      </div>
      <button
        className="community-create-button"
        onClick={() => onNavigate("communityCreate")}
      >
        +
      </button>{" "}
    </div>
    <BottomNavigation currentPage="community" onNavigate={onNavigate} />
  </div>
);

const CommunityDetailPage = ({ onNavigate }) => {
  const [comment, setComment] = React.useState("");

  const handleSubmitComment = () => {
    if (comment.trim()) {
      // ÎåìÍ∏Ä Ï†úÏ∂ú Î°úÏßÅ
      setComment("");
    }
  };

  return (
    <div className="container" style={{ backgroundColor: "white" }}>
      <div
        style={{
          padding: "1rem",
          display: "flex",
          alignItems: "center",
          position: "sticky",
          top: 0,
          backgroundColor: "white",
          zIndex: 10,
          borderBottom: "1px solid #e5e7eb",
        }}
      >
        <button onClick={() => onNavigate("back")} className="back-button">
          ‚Üê
        </button>
        <h1
          style={{
            flex: 1,
            textAlign: "center",
            fontSize: "1.25rem",
            fontWeight: "bold",
          }}
        >
          Í≤åÏãúÍ∏Ä ÏÉÅÏÑ∏
        </h1>
        <div style={{ width: "2rem" }} />
      </div>

      <div
        style={{
          flex: 1,
          padding: "1.5rem 2rem",
          height: "calc(100% - 8rem)",
          overflowY: "auto",
        }}
      >
        <div style={{ marginBottom: "1.5rem" }}>
          <div
            style={{
              display: "flex",
              justifyContent: "space-between",
              alignItems: "center",
              marginBottom: "1rem",
            }}
          >
            <h2 style={{ fontSize: "1.25rem", fontWeight: "bold" }}>
              Ïö¥Îèô Ï¥àÎ≥¥Ïûê PT Ï∂îÏ≤úÌï¥Ï£ºÏÑ∏Ïöî
            </h2>
            <div style={{ display: "flex", gap: "1rem", color: "#6b7280" }}>
              <span>üëç 24</span>
              <span>üí¨ 12</span>
            </div>
          </div>
          <div
            style={{
              display: "flex",
              justifyContent: "space-between",
              color: "#6b7280",
              fontSize: "0.875rem",
              marginBottom: "1.5rem",
            }}
          >
            <span>Ìó¨Î¶∞Ïù¥</span>
            <span>2024-02-06</span>
          </div>
          <p style={{ lineHeight: "1.6", marginBottom: "2rem" }}>
            ÏïàÎÖïÌïòÏÑ∏Ïöî! Ïö¥ÎèôÏùÑ Ï≤òÏùå ÏãúÏûëÌïòÎ†§Í≥† ÌïòÎäîÎç∞ PTÎ•º Î∞õÏïÑÎ≥¥Î†§Í≥† Ìï©ÎãàÎã§.
            Ï†úÍ∞Ä ÏÇ¨Îäî Í≥≥ Í∑ºÏ≤òÏóê Ìó¨Ïä§Ïû•Ïù¥ Î™á Íµ∞Îç∞ ÏûàÎäîÎç∞, Ïñ¥Îñ§ Í∏∞Ï§ÄÏúºÎ°ú PT
            Ìä∏Î†àÏù¥ÎÑàÎ•º ÏÑ†ÌÉùÌï¥Ïïº Ìï†ÏßÄ Î™®Î•¥Í≤†Ïñ¥Ïöî. Í≤ΩÌóò ÏûàÏúºÏã† Î∂ÑÎì§Ïùò Ï°∞Ïñ∏
            Î∂ÄÌÉÅÎìúÎ¶ΩÎãàÎã§!
          </p>
        </div>

        <div style={{ marginBottom: "1.5rem" }}>
          <h3 style={{ fontWeight: "bold", marginBottom: "1rem" }}>ÎåìÍ∏Ä 12</h3>
          <div
            style={{ display: "flex", flexDirection: "column", gap: "1rem" }}
          >
            {Array.from({ length: 5 }).map((_, idx) => (
              <div
                key={idx}
                style={{
                  padding: "1rem",
                  backgroundColor: "#f3f4f6",
                  borderRadius: "0.5rem",
                }}
              >
                <div
                  style={{
                    display: "flex",
                    justifyContent: "space-between",
                    marginBottom: "0.5rem",
                  }}
                >
                  <span style={{ fontWeight: "500" }}>Ïö¥ÎèôÎß§ÎãàÏïÑ{idx + 1}</span>
                  <span style={{ color: "#6b7280", fontSize: "0.875rem" }}>
                    2024-02-06
                  </span>
                </div>
                <p style={{ lineHeight: "1.5" }}>
                  Ï¥àÎ≥¥ÏûêÎùºÎ©¥ Í∏∞Ï¥à ÏûêÏÑ∏Î∂ÄÌÑ∞ ÍººÍººÌûà Î¥êÏ£ºÏã§ Ïàò ÏûàÎäî Ìä∏Î†àÏù¥ÎÑàÎ•º
                  Ï∂îÏ≤úÎìúÎ¶ΩÎãàÎã§. Í≤ΩÎ†•ÎèÑ Ï§ëÏöîÌïòÏßÄÎßå ÏàòÏóÖ Ïä§ÌÉÄÏùºÎèÑ Í≥†Î†§Ìï¥Î≥¥ÏÑ∏Ïöî!
                </p>
              </div>
            ))}
          </div>
        </div>
      </div>

      <div
        style={{
          padding: "1rem 2rem",
          backgroundColor: "white",
          borderTop: "1px solid #e5e7eb",
          position: "sticky",
          bottom: 0,
        }}
      >
        <div style={{ display: "flex", gap: "0.75rem" }}>
          <input
            type="text"
            value={comment}
            onChange={(e) => setComment(e.target.value)}
            placeholder="ÎåìÍ∏ÄÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî"
            style={{
              flex: 1,
              padding: "0.75rem",
              border: "1px solid #e5e7eb",
              borderRadius: "0.5rem",
              outline: "none",
              fontSize: "0.875rem",
              backgroundColor: "white",
              color: "black",
            }}
          />
          <button
            onClick={handleSubmitComment}
            className="primary-button"
            style={{
              width: "auto",
              padding: "0.75rem 1.5rem",
              opacity: comment.trim() ? 1 : 0.5,
              cursor: comment.trim() ? "pointer" : "default",
              whiteSpace: "nowrap",
            }}
          >
            Îì±Î°ù
          </button>
        </div>
      </div>
    </div>
  );
};

const CommunityCreatePage = ({ onNavigate }) => {
  const [title, setTitle] = React.useState("");
  const [content, setContent] = React.useState("");

  const handleSubmit = () => {
    if (title.trim() && content.trim()) {
      onNavigate("back");
    }
  };

  return (
    <div
      className="container"
      style={{
        backgroundColor: "white",
        display: "flex",
        flexDirection: "column",
        height: "100%",
      }}
    >
      {/* Header */}
      <div
        style={{
          padding: "1rem",
          display: "flex",
          alignItems: "center",
          backgroundColor: "white",
          borderBottom: "1px solid #e5e7eb",
        }}
      >
        <button onClick={() => onNavigate("back")} className="back-button">
          ‚Üê
        </button>
        <h1
          style={{
            flex: 1,
            textAlign: "center",
            fontSize: "1.25rem",
            fontWeight: "bold",
          }}
        >
          Í∏ÄÏì∞Í∏∞
        </h1>
        <button
          onClick={handleSubmit}
          className="primary-button"
          style={{
            width: "auto",
            padding: "0.5rem 1rem",
            opacity: title.trim() && content.trim() ? 1 : 0.5,
            cursor: title.trim() && content.trim() ? "pointer" : "default",
          }}
        >
          Îì±Î°ù
        </button>
      </div>

      {/* Content Area */}
      <div
        style={{
          flex: 1,
          display: "flex",
          flexDirection: "column",
          padding: "1.5rem ",
          backgroundColor: "white",
        }}
      >
        {/* Title Input */}
        <div style={{ marginBottom: "1.5rem" }}>
          <input
            type="text"
            placeholder="Ï†úÎ™©ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî (ÌïÑÏàò)"
            value={title}
            onChange={(e) => setTitle(e.target.value)}
            style={{
              width: "100%",
              padding: "0.75rem 0",
              fontSize: "1.125rem",
              border: "none",
              borderBottom: "1px solid #e5e7eb",
              outline: "none",
              backgroundColor: "white",
              color: "black",
            }}
          />
        </div>

        {/* Content Input */}
        <div>
          <textarea
            placeholder="ÎÇ¥Ïö©ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî(ÌïÑÏàò)"
            value={content}
            onChange={(e) => setContent(e.target.value)}
            style={{
              width: "100%",
              height: "50vh",
              boxSizing: "border-box",
              padding: "0.75rem 0.75rem",
              fontSize: "1rem",
              border: "1px solid #e5e7eb",
              borderRadius: 5,
              outline: "none",
              resize: "none",
              lineHeight: "1.5",
              backgroundColor: "white",
              color: "black",
            }}
          />
        </div>
      </div>
    </div>
  );
};

const PaymentPage = ({ onNavigate, plan, source }) => {
  // sourceÎäî 'gym' ÎòêÎäî 'trainer'Î•º Í∞íÏúºÎ°ú Í∞ÄÏßê
  const renderPaymentInfo = () => {
    if (source === "gym") {
      return (
        <div
          style={{
            padding: "1rem",
            backgroundColor: "#f3f4f6",
            borderRadius: "0.5rem",
          }}
        >
          <p style={{ fontWeight: "500", marginBottom: "0.5rem" }}>
            Ïä§ÎßàÌä∏ ÌîºÌä∏ÎãàÏä§
          </p>
          <p
            style={{
              fontWeight: "bold",
              color: "#3b82f6",
              marginBottom: "0.5rem",
            }}
          >
            {plan.duration} Ïù¥Ïö©Í∂å
          </p>
          <p style={{ color: "#6b7280" }}>{plan.price}/Ïõî</p>
        </div>
      );
    } else if (source === "trainer") {
      return (
        <div
          style={{
            padding: "1rem",
            backgroundColor: "#f3f4f6",
            borderRadius: "0.5rem",
          }}
        >
          <p style={{ fontWeight: "500", marginBottom: "0.5rem" }}>
            ÍπÄÌä∏Î†àÏù¥ÎÑà
          </p>
          <p
            style={{
              fontWeight: "bold",
              color: "#3b82f6",
              marginBottom: "0.5rem",
            }}
          >
            {plan.sessions} PT Ïù¥Ïö©Í∂å
          </p>
          <div style={{ color: "#6b7280" }}>
            <p>ÌöåÎãπ {plan.pricePerSession}</p>
            <p style={{ marginTop: "0.25rem" }}>Ï¥ù {plan.totalPrice}</p>
          </div>
        </div>
      );
    }
  };

  return (
    <div className="container" style={{ backgroundColor: "white" }}>
      <div
        style={{
          padding: "1rem",
          display: "flex",
          alignItems: "center",
          position: "sticky",
          top: 0,
          backgroundColor: "white",
          zIndex: 10,
        }}
      >
        <button onClick={() => onNavigate("back")} className="back-button">
          ‚Üê
        </button>
        <h1
          style={{
            flex: 1,
            textAlign: "center",
            fontSize: "1.25rem",
            fontWeight: "bold",
          }}
        >
          Í≤∞Ï†úÌïòÍ∏∞
        </h1>
        <div style={{ width: "2rem" }} />
      </div>

      <div style={{ flex: 1, padding: "1rem 2rem", overflow: "auto" }}>
        <div style={{ marginBottom: "2rem" }}>
          <h3 style={{ fontWeight: "bold", marginBottom: "1rem" }}>
            Í≤∞Ï†ú ÏÉÅÌíà
          </h3>
          {renderPaymentInfo()}
        </div>

        <div style={{ marginBottom: "2rem" }}>
          <h3 style={{ fontWeight: "bold", marginBottom: "1rem" }}>
            Í≤∞Ï†ú ÏàòÎã®
          </h3>
          <div
            style={{ display: "flex", flexDirection: "column", gap: "0.5rem" }}
          >
            <button className="secondary-button" style={{ padding: "1rem" }}>
              Ïã†Ïö©/Ï≤¥ÌÅ¨Ïπ¥Îìú
            </button>
            <button className="secondary-button" style={{ padding: "1rem" }}>
              Î¨¥ÌÜµÏû•ÏûÖÍ∏à
            </button>
            <button className="secondary-button" style={{ padding: "1rem" }}>
              Ïπ¥Ïπ¥Ïò§ÌéòÏù¥
            </button>
          </div>
        </div>
      </div>

      <div
        style={{
          padding: "1rem",
          backgroundColor: "white",
          borderTop: "1px solid #e5e7eb",
          position: "sticky",
          bottom: 0,
        }}
      >
        <div style={{ display: "flex", gap: "0.5rem" }}>
          <button
            className="secondary-button"
            onClick={() => onNavigate("back")}
            style={{ flex: 1 }}
          >
            Ï∑®ÏÜå
          </button>
          <button className="primary-button" style={{ flex: 1 }}>
            Í≤∞Ï†úÌïòÍ∏∞
          </button>
        </div>
      </div>
    </div>
  );
};

const App = () => {
  const [currentPage, setCurrentPage] = React.useState("main");
  const [navigationStack, setNavigationStack] = React.useState([]);
  const [selectedLocation, setSelectedLocation] = React.useState("ÏßÄÏó≠ ÏÑ†ÌÉù");
  const [navigationParams, setNavigationParams] = React.useState({}); // Îπà Í∞ùÏ≤¥Î°ú Ï¥àÍ∏∞Ìôî

  React.useEffect(() => {
    // Ï¥àÍ∏∞ ÌûàÏä§ÌÜ†Î¶¨ ÏÉÅÌÉú ÏÑ§Ï†ï
    window.history.replaceState({ page: "main", stack: [] }, "");

    const handlePopState = (event) => {
      const state = event.state;
      if (state) {
        setCurrentPage(state.page);
        setNavigationStack(state.stack || []);
      }
    };

    window.addEventListener("popstate", handlePopState);
    return () => {
      window.removeEventListener("popstate", handlePopState);
    };
  }, []);

  const navigateTo = (page, params = {}) => {
    if (page === "back") {
      if (navigationStack.length > 0) {
        const newStack = [...navigationStack];
        const previousPage = newStack.pop();
        setNavigationStack(newStack);
        setCurrentPage(previousPage);
        window.history.pushState(
          {
            page: previousPage,
            stack: newStack,
          },
          ""
        );
      }
      if (params.selectedLocation) {
        setSelectedLocation(params.selectedLocation);
      }
    } else {
      const isMainPage = [
        "main",
        "gyms",
        "trainers",
        "community",
        "mypage",
      ].includes(page);
      let newStack;

      if (!isMainPage) {
        newStack = [...navigationStack, currentPage];
        setNavigationStack(newStack);
      } else {
        newStack = [];
        setNavigationStack(newStack);
      }

      setCurrentPage(page);
      setNavigationParams(params);

      window.history.pushState(
        {
          page: page,
          stack: newStack,
        },
        ""
      );
    }
  };

  const showBottomNav = [
    "main",
    "gyms",
    "trainers",
    "community",
    "mypage",
  ].includes(currentPage);

  const renderPage = () => {
    const commonProps = {
      onNavigate: navigateTo,
      currentLocation: selectedLocation,
    };

    switch (currentPage) {
      case "main":
        return <MainPage {...commonProps} />;
      case "location":
        return <LocationPage {...commonProps} />;
      case "gyms":
        return <GymListPage {...commonProps} />;
      case "gymDetail":
        return <GymDetailPage {...commonProps} />;
      case "trainers":
        return <TrainerListPage {...commonProps} />;
      case "trainerDetail":
        return <TrainerDetailPage {...commonProps} />;
      case "community":
        return <CommunityPage {...commonProps} />;
      case "communityDetail":
        return <CommunityDetailPage {...commonProps} />;
      case "communityCreate":
        return <CommunityCreatePage {...commonProps} />;
      case "mypage":
        return <MyPage {...commonProps} />;
      case "payment":
        return (
          <PaymentPage
            {...commonProps}
            plan={navigationParams.plan}
            source={navigationParams.source}
          />
        );
      default:
        return <MainPage {...commonProps} />;
    }
  };

  return (
    <div className="app-wrapper">
      {renderPage()}
      {showBottomNav && (
        <BottomNavigation currentPage={currentPage} onNavigate={navigateTo} />
      )}
    </div>
  );
};

export default App;
